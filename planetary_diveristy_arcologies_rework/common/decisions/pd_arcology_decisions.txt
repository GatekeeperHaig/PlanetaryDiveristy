##########################################################################
# Decisions
##########################################################################

# Garden Arcology Project
decision_pd_garden_arcology_project = {
	owned_planets_only = yes
	icon = decision_pd_garden_arcology_project

	enactment_time = 3600
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
	}

	potential = {
		NOR = {
			is_planet_class = pc_city
			is_planet_class = pc_relic
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
			has_modifier = pm_wenkwort_custodian
		}
		is_artificial = no
		exists = owner
		owner = {
			has_ascension_perk = ap_arcology_project
			OR = {
				has_tradition = tr_adaptability_adopt
				has_tradition = tr_discovery_adopt
			}
		}
	}

	allow = {
		custom_tooltip = {
			fail_text = decision_arcology_project_requirements
			free_district_slots < 1
			num_districts = { type = district_farming value < 1 }
			num_districts = { type = district_mining value < 1 }
			num_districts = { type = district_generator value < 1 }
			num_districts = { type = district_farming_uncapped value < 1 }
			num_districts = { type = district_mining_uncapped value < 1 }
			num_districts = { type = district_generator_uncapped value < 1 }
		}
		custom_tooltip = {
			fail_text = legendary_leader_decision_arcology_project
			NOT = { has_planet_flag = legendary_leader_planet }
		}
		num_uncleared_blockers < 1
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			clear_deposits = yes
			set_planet_flag = factory_planet
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_arms_industry
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			if = {
				limit = {
					NOR = {
						has_planet_flag = planet_earth
						has_planet_flag = planet_mars
						has_planet_flag = pdvenus
					}
				}
				set_planet_entity = {
					picture = pc_pd_garden_city
					entity = "pdgarden_city_planet_01_entity"
					graphical_culture = owner
				}
			}
			if = {
				limit = {
					has_planet_flag = planet_earth
				}
				set_planet_entity = {
					picture = pc_pd_garden_city
					entity = pd_garden_city_planet_earth_01_entity
				}
			}
			if = {
				limit = {
					has_planet_flag = planet_mars
				}
				set_planet_entity = {
					picture = pc_pd_garden_city
					entity = pd_garden_city_planet_mars_01_entity
				}
			}
			if = {
				limit = {
					has_planet_flag = pdvenus
				}
				set_planet_entity = {
					picture = pc_pd_garden_city
					entity = pd_garden_city_planet_venus_01_entity
				}
			}
			planet_event = { id = action.68 }
			owner = {
				country_event = { id = distar.201 } # port for living planet distar.197, triggers in event
			}
			planet_event = { id = mega.200 }
			if = {
				limit = {
					OR = {
						is_active_resolution = "resolution_ecology_environmental_control_board"
						is_active_resolution = "resolution_ecology_paradise_initiative"
					}
				}
				owner = {
					set_timed_country_flag = { flag = resolution_breached_terraformed days = 3600 }
				}
			}
			add_modifier = {
				modifier = pd_garden_arcology
				days = -1
			}
		}
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 100
			exists = owner
			OR = {
				num_pops >= 70
				is_capital = yes
			}
		}
	}
}
# Garden Arcology Project (Relic Worlds)
decision_pd_garden_arcology_project_relic = {
	owned_planets_only = yes
	icon = decision_pd_garden_arcology_project

	enactment_time = 3600
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
	}

	potential = {
		is_planet_class = pc_relic
		is_artificial = no
		exists = owner
		owner = {
			OR = {
				is_regular_empire = yes
				has_valid_civic = civic_machine_servitor
			}
			OR = {
				has_tradition = tr_adaptability_adopt
				has_tradition = tr_discovery_adopt
			}
		}
	}

	allow = {
		num_uncleared_blockers < 1
		owner = { has_technology = tech_housing_2 }
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			clear_deposits = yes
			set_planet_flag = factory_planet
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_arms_industry
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			if = {
				limit = {
					NOR = {
						has_planet_flag = planet_earth
						has_planet_flag = planet_mars
						has_planet_flag = pdvenus
					}
				}
				set_planet_entity = {
					picture = pc_pd_garden_city
					entity = "pdgarden_city_planet_01_entity"
					graphical_culture = owner
				}
			}
			if = {
				limit = {
					has_planet_flag = planet_earth
				}
				set_planet_entity = {
					picture = pc_pd_garden_city
					entity = pd_garden_city_planet_earth_01_entity
				}
			}
			if = {
				limit = {
					has_planet_flag = planet_mars
				}
				set_planet_entity = {
					picture = pc_pd_garden_city
					entity = pd_garden_city_planet_mars_01_entity
				}
			}
			if = {
				limit = {
					has_planet_flag = pdvenus
				}
				set_planet_entity = {
					picture = pc_pd_garden_city
					entity = pd_garden_city_planet_venus_01_entity
				}
			}
			planet_event = { id = action.68 }
			add_deposit = d_former_relic_world
			planet_event = { id = mega.201 }
			while = {
				count = 4
				solar_system = {
					random_system_ambient_object = {
						limit = { has_ambient_object_flag = relic_world_debris }
						destroy_ambient_object = this
					}
				}
			}
			if = {
				limit = {
					OR = {
						is_active_resolution = "resolution_ecology_environmental_control_board"
						is_active_resolution = "resolution_ecology_paradise_initiative"
					}
				}
				owner = {
					set_timed_country_flag = { flag = resolution_breached_terraformed days = 3600 }
				}
			}
			add_modifier = {
				modifier = pd_garden_arcology
				days = -1
			}
		}
	}

	ai_weight = {
		weight = 100
	}
}

# Fortress Arcology Project
decision_pd_fortress_arcology_project = {
	owned_planets_only = yes
	icon = decision_pd_fortress_arcology_project

	enactment_time = 3600
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
	}

	potential = {
		NOR = {
			is_planet_class = pc_city
			is_planet_class = pc_relic
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
			has_modifier = pm_wenkwort_custodian
		}
		is_artificial = no
		exists = owner
		owner = {
			has_ascension_perk = ap_arcology_project
			OR = {
				has_tradition = tr_supremacy_adopt
				has_tradition = tr_unyielding_adopt
			}
		}
	}

	allow = {
		custom_tooltip = {
			fail_text = decision_arcology_project_requirements
			free_district_slots < 1
			num_districts = { type = district_farming value < 1 }
			num_districts = { type = district_mining value < 1 }
			num_districts = { type = district_generator value < 1 }
			num_districts = { type = district_farming_uncapped value < 1 }
			num_districts = { type = district_mining_uncapped value < 1 }
			num_districts = { type = district_generator_uncapped value < 1 }
		}
		custom_tooltip = {
			fail_text = legendary_leader_decision_arcology_project
			NOT = { has_planet_flag = legendary_leader_planet }
		}
		num_uncleared_blockers < 1
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			clear_deposits = yes
			set_planet_flag = foundry_planet
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_arms_industry
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			set_planet_entity = {
				picture = pc_pd_fortress_city
				entity = "pd_fortress_city_planet_01_entity"
				graphical_culture = owner
			}
			planet_event = { id = action.68 }
			owner = {
				country_event = { id = distar.201 } # port for living planet distar.197, triggers in event
			}
			planet_event = { id = mega.200 }
			if = {
				limit = {
					OR = {
						is_active_resolution = "resolution_ecology_environmental_control_board"
						is_active_resolution = "resolution_ecology_paradise_initiative"
					}
				}
				owner = {
					set_timed_country_flag = { flag = resolution_breached_terraformed days = 3600 }
				}
			}
			add_modifier = {
				modifier = pd_fortress_arcology
				days = -1
			}
		}
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 100
			exists = owner
			OR = {
				num_pops >= 70
				is_capital = yes
			}
		}
	}
}
# Fortress Arcology Project (Relic Worlds)
decision_pd_fortress_arcology_project_relic = {
	owned_planets_only = yes
	icon = decision_pd_fortress_arcology_project

	enactment_time = 3600
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
	}

	potential = {
		is_planet_class = pc_relic
		is_artificial = no
		exists = owner
		owner = {
			OR = {
				is_regular_empire = yes
				has_valid_civic = civic_machine_servitor
			}
			OR = {
				has_tradition = tr_adaptability_adopt
				has_tradition = tr_discovery_adopt
			}
		}
	}

	allow = {
		num_uncleared_blockers < 1
		owner = { has_technology = tech_housing_2 }
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			clear_deposits = yes
			set_planet_flag = foundry_planet
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_arms_industry
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			set_planet_entity = {
				picture = pc_pd_fortress_city
				entity = "pd_fortress_city_planet_01_entity"
				graphical_culture = owner
			}
			planet_event = { id = action.68 }
			add_deposit = d_former_relic_world
			planet_event = { id = mega.201 }
			while = {
				count = 4
				solar_system = {
					random_system_ambient_object = {
						limit = { has_ambient_object_flag = relic_world_debris }
						destroy_ambient_object = this
					}
				}
			}
			if = {
				limit = {
					OR = {
						is_active_resolution = "resolution_ecology_environmental_control_board"
						is_active_resolution = "resolution_ecology_paradise_initiative"
					}
				}
				owner = {
					set_timed_country_flag = { flag = resolution_breached_terraformed days = 3600 }
				}
			}
			add_modifier = {
				modifier = pd_fortress_arcology
				days = -1
			}
		}
	}

	ai_weight = {
		weight = 100
	}
}

# Commerical Arcology Project
decision_pd_commerical_arcology_project = {
	owned_planets_only = yes
	icon = decision_pd_commerical_arcology_project

	enactment_time = 3600
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
	}

	potential = {
		NOR = {
			is_planet_class = pc_city
			is_planet_class = pc_relic
			has_modifier = resort_colony
			has_modifier = penal_colony
			has_modifier = slave_colony
			has_modifier = pm_wenkwort_custodian
		}
		is_artificial = no
		exists = owner
		owner = {
			has_ascension_perk = ap_arcology_project
			OR = {
				has_tradition = tr_prosperity_adopt
				has_tradition = tr_mercantile_adopt
			}
		}
	}

	allow = {
		custom_tooltip = {
			fail_text = decision_arcology_project_requirements
			free_district_slots < 1
			num_districts = { type = district_farming value < 1 }
			num_districts = { type = district_mining value < 1 }
			num_districts = { type = district_generator value < 1 }
			num_districts = { type = district_farming_uncapped value < 1 }
			num_districts = { type = district_mining_uncapped value < 1 }
			num_districts = { type = district_generator_uncapped value < 1 }
		}
		custom_tooltip = {
			fail_text = legendary_leader_decision_arcology_project
			NOT = { has_planet_flag = legendary_leader_planet }
		}
		num_uncleared_blockers < 1
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			clear_deposits = yes
			set_industrial_focus_flags = yes
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_pd_arcology_industrial
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			set_planet_entity = {
				picture = pc_pd_commerical_city
				entity = "pd_commerical_city_planet_01_entity"
				graphical_culture = owner
			}
			planet_event = { id = action.68 }
			owner = {
				country_event = { id = distar.201 } # port for living planet distar.197, triggers in event
			}
			planet_event = { id = mega.200 }
			if = {
				limit = {
					OR = {
						is_active_resolution = "resolution_ecology_environmental_control_board"
						is_active_resolution = "resolution_ecology_paradise_initiative"
					}
				}
				owner = {
					set_timed_country_flag = { flag = resolution_breached_terraformed days = 3600 }
				}
			}
			add_modifier = {
				modifier = pd_commerical_arcology
				days = -1
			}
		}
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 100
			exists = owner
			OR = {
				num_pops >= 70
				is_capital = yes
			}
		}
	}
}
# Commerical Arcology Project (Relic Worlds)
decision_pd_commerical_arcology_project_relic = {
	owned_planets_only = yes
	icon = decision_pd_commerical_arcology_project

	enactment_time = 3600
	resources = {
		category = decisions
		cost = {
			influence = 200
			minerals = 20000
		}
	}

	potential = {
		is_planet_class = pc_relic
		is_artificial = no
		exists = owner
		owner = {
			OR = {
				is_regular_empire = yes
				has_valid_civic = civic_machine_servitor
			}
			OR = {
				has_tradition = tr_prosperity_adopt
				has_tradition = tr_mercantile_adopt
			}
		}
	}

	allow = {
		num_uncleared_blockers < 1
		owner = { has_technology = tech_housing_2 }
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			clear_deposits = yes
			set_industrial_focus_flags = yes
			change_pc = pc_city
			relic_world_conversion_effect = {
				DISTRICT = district_arcology_housing
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_pd_arcology_industrial
				VARIABLE = num_industrial_districts
			}
			set_ecu_industrial_districts_effect = yes
			set_planet_entity = {
				picture = pc_pd_commerical_city
				entity = "pd_commerical_city_planet_01_entity"
				graphical_culture = owner
			}
			planet_event = { id = action.68 }
			add_deposit = d_former_relic_world
			planet_event = { id = mega.201 }
			while = {
				count = 4
				solar_system = {
					random_system_ambient_object = {
						limit = { has_ambient_object_flag = relic_world_debris }
						destroy_ambient_object = this
					}
				}
			}
			if = {
				limit = {
					OR = {
						is_active_resolution = "resolution_ecology_environmental_control_board"
						is_active_resolution = "resolution_ecology_paradise_initiative"
					}
				}
				owner = {
					set_timed_country_flag = { flag = resolution_breached_terraformed days = 3600 }
				}
			}
			add_modifier = {
				modifier = pd_commerical_arcology
				days = -1
			}
		}
	}

	ai_weight = {
		weight = 100
	}
}

# Hive Overmind World
decision_pd_hive_overmind_project = {
	owned_planets_only = yes
	icon = decision_pd_hive_overmind_project

	enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			influence = 100
			minerals = 10000
		}
	}

	potential = {
		is_planet_class = pc_hive
		exists = owner
		owner = { has_ascension_perk = ap_hive_worlds }
	}

	allow = {
		custom_tooltip = {
			fail_text = decision_arcology_project_requirements
			free_district_slots < 1
			num_districts = { type = district_farming value < 1 }
			num_districts = { type = district_mining value < 1 }
			num_districts = { type = district_generator value < 1 }
			num_districts = { type = district_farming_uncapped value < 1 }
			num_districts = { type = district_mining_uncapped value < 1 }
			num_districts = { type = district_generator_uncapped value < 1 }
		}
		num_uncleared_blockers < 1
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			clear_deposits = yes
			set_industrial_focus_flags = yes
			change_pc = pc_pd_hive
			relic_world_conversion_effect = {
				DISTRICT = district_pd_hive
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_pd_hive_industrial
				VARIABLE = num_industrial_districts
			}
			if = {
				limit = {
					OR = {
						is_active_resolution = "resolution_ecology_environmental_control_board"
						is_active_resolution = "resolution_ecology_paradise_initiative"
					}
				}
				owner = {
					set_timed_country_flag = { flag = resolution_breached_terraformed days = 3600 }
				}
			}
			add_modifier = {
				modifier = pd_hive_military
				days = -1
			}
		}
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 100
			exists = owner
			OR = {
				num_pops >= 70
				is_capital = yes
			}
		}
	}
}

# Machine Nexus World
decision_pd_machine_nexus_project = {
	owned_planets_only = yes
	icon = decision_pd_machine_nexus_project

	enactment_time = 1800
	resources = {
		category = decisions
		cost = {
			influence = 100
			minerals = 10000
		}
	}

	potential = {
		is_planet_class = pc_machine
		exists = owner
		owner = { has_ascension_perk = ap_machine_worlds }
	}

	allow = {
		custom_tooltip = {
			fail_text = decision_arcology_project_requirements
			free_district_slots < 1
			num_districts = { type = district_farming value < 1 }
			num_districts = { type = district_mining value < 1 }
			num_districts = { type = district_generator value < 1 }
			num_districts = { type = district_farming_uncapped value < 1 }
			num_districts = { type = district_mining_uncapped value < 1 }
			num_districts = { type = district_generator_uncapped value < 1 }
		}
		num_uncleared_blockers < 1
	}

	effect = {
		# Make city-planet
		custom_tooltip = decision_arcology_project_effects
		hidden_effect = {
			clear_deposits = yes
			set_industrial_focus_flags = yes
			change_pc = pc_pd_machine
			relic_world_conversion_effect = {
				DISTRICT = district_pd_hive
				VARIABLE = num_housing_districts
			}
			relic_world_conversion_effect = {
				DISTRICT = district_pd_hive_industrial
				VARIABLE = num_industrial_districts
			}
			if = {
				limit = {
					OR = {
						is_active_resolution = "resolution_ecology_environmental_control_board"
						is_active_resolution = "resolution_ecology_paradise_initiative"
					}
				}
				owner = {
					set_timed_country_flag = { flag = resolution_breached_terraformed days = 3600 }
				}
			}
			add_modifier = {
				modifier = pd_machine_military
				days = -1
			}
		}
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 100
			exists = owner
			OR = {
				num_pops >= 70
				is_capital = yes
			}
		}
	}
}